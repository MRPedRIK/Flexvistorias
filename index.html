<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Flex Vistorias - Sistema Completo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary:#1a1a1a; --secondary:#ff6b35; --accent:#ff8c42; --light:#f8f9fa; --white:#ffffff;
      --muted:#6c757d; --success:#28a745; --danger:#dc3545; --warning:#ffc107; --info:#17a2b8;
      --dark:#212529; --orange-light:#fff3e0; --orange-dark:#e65c00;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background:#f8f9fa; color:#212529; display:flex; min-height:100vh; }
    
    /* Sidebar Modernizada */
    .sidebar { width:280px; background:var(--primary); color:var(--white); padding:0; display:flex; flex-direction:column; transition: all 0.3s; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
    .logo { padding:24px; margin-bottom:0; border-bottom:1px solid rgba(255,107,53,0.2); background:linear-gradient(135deg, var(--primary) 0%, #2a2a2a 100%); }
    .logo h2 { margin:0; font-size:22px; font-weight:700; display:flex; align-items:center; gap:10px; }
    .logo i { color:var(--secondary); filter: drop-shadow(0 2px 4px rgba(255,107,53,0.3)); }
    .menu { list-style:none; margin:0; padding:16px 0; flex:1; }
    .menu li { display:flex; align-items:center; gap:12px; padding:12px 24px; cursor:pointer; transition:all 0.3s; border-left:4px solid transparent; position: relative; overflow: hidden; }
    .menu li:before { content: ''; position: absolute; left: -100%; top: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,107,53,0.1), transparent); transition: left 0.5s; }
    .menu li:hover:before { left: 100%; }
    .menu li:hover { background:rgba(255,107,53,0.08); transform: translateX(5px); }
    .menu li.active { background:linear-gradient(90deg, rgba(255,107,53,0.15), transparent); border-left-color:var(--secondary); box-shadow: inset 0 0 20px rgba(255,107,53,0.1); }
    .menu li i { width:20px; text-align:center; transition: all 0.3s; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2)); }
    .menu li:hover i { transform: scale(1.1); color: var(--accent); filter: drop-shadow(0 2px 6px rgba(255,107,53,0.4)); }
    .menu li.active i { color: var(--secondary); transform: scale(1.1); filter: drop-shadow(0 2px 8px rgba(255,107,53,0.6)); }
    .logout { padding:16px 24px; border-top:1px solid rgba(255,107,53,0.2); background:linear-gradient(135deg, #2a2a2a 0%, var(--primary) 100%); }
    
    /* Main Content */
    .main { flex:1; padding:0; overflow:hidden; display:flex; flex-direction:column; }
    .header { background:var(--white); padding:20px 30px; border-bottom:1px solid #dee2e6; box-shadow:0 2px 10px rgba(0,0,0,0.08); }
    .header-content { display:flex; align-items:center; justify-content:space-between; max-width:1400px; margin:0 auto; }
    .header h1 { margin:0; font-size:28px; font-weight:700; color:var(--primary); background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .userbox { display:flex; align-items:center; gap:15px; }
    .user-info { text-align:right; }
    .user-name { font-weight:600; color:var(--primary); }
    .user-role { font-size:12px; color:var(--muted); }
    .avatar { width:44px; height:44px; background:linear-gradient(135deg, var(--secondary), var(--accent)); color:#fff; border-radius:12px; display:grid; place-items:center; font-weight:700; font-size:18px; box-shadow: 0 4px 8px rgba(255,107,53,0.3); }
    
    /* Content Area */
    .content { flex:1; padding:30px; overflow-y:auto; background:#f8f9fa; }
    .container { max-width:1400px; margin:0 auto; }
    
    /* Cards Modernizados */
    .cards { display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:24px; margin-bottom:30px; }
    .card { background:var(--white); border-radius:16px; padding:24px; box-shadow:0 4px 20px rgba(0,0,0,0.08); border:1px solid #e9ecef; transition:all 0.3s; position: relative; overflow: hidden; }
    .card:before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--secondary), var(--accent)); }
    .card:hover { transform:translateY(-5px); box-shadow:0 8px 30px rgba(0,0,0,0.12); }
    .card-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
    .card-icon { width:60px; height:60px; border-radius:16px; display:grid; place-items:center; font-size:24px; transition: all 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.1); position: relative; }
    .card-icon:before { content: ''; position: absolute; width: 100%; height: 100%; border-radius: 16px; background: inherit; filter: blur(8px); opacity: 0.3; z-index: -1; }
    .card-icon.primary { background:linear-gradient(135deg, var(--secondary), var(--accent)); color:#fff; }
    .card-icon.success { background:linear-gradient(135deg, #28a745, #20c997); color:#fff; }
    .card-icon.danger { background:linear-gradient(135deg, #dc3545, #e83e8c); color:#fff; }
    .card-icon.warning { background:linear-gradient(135deg, #ffc107, #fd7e14); color:#fff; }
    .card-icon.purple { background:linear-gradient(135deg, #6f42c1, #e83e8c); color:#fff; }
    .card-icon.info { background:linear-gradient(135deg, #17a2b8, #20c997); color:#fff; }
    .card:hover .card-icon { transform: scale(1.1) rotate(5deg); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
    .card h4 { margin:0; font-size:14px; color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.5px; }
    .card .val { font-size:32px; font-weight:800; margin:8px 0; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .card .progress { height:8px; background:#e9ecef; border-radius:4px; margin:12px 0; overflow:hidden; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); }
    .card .progress-bar { height:100%; border-radius:4px; transition: width 1s ease-in-out; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .card-footer { display:flex; justify-content:space-between; align-items:center; margin-top:12px; font-size:13px; color:var(--muted); }
    
    /* Panels */
    .panel { background:var(--white); border-radius:16px; padding:28px; box-shadow:0 4px 20px rgba(0,0,0,0.08); border:1px solid #e9ecef; margin-bottom:30px; position: relative; overflow: hidden; }
    .panel:before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--secondary), var(--accent)); }
    .panel-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:24px; }
    .panel h3 { margin:0; font-size:20px; font-weight:700; color:var(--primary); }
    .panel-actions { display:flex; gap:10px; }
    
    /* Forms Modernizados */
    .row { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:16px; margin-bottom:16px; }
    .form-group { margin-bottom:20px; position: relative; }
    .form-label { display:block; margin-bottom:8px; font-weight:600; color:var(--primary); font-size:14px; }
    input, select, textarea { width:100%; padding:12px 16px; border:2px solid #e9ecef; border-radius:10px; outline:none; font-size:14px; transition:all 0.3s; background:var(--white); }
    input:focus, select:focus, textarea:focus { border-color:var(--secondary); box-shadow:0 0 0 3px rgba(255,107,53,0.1); transform: translateY(-2px); }
    .btn { border:0; border-radius:10px; padding:12px 24px; font-weight:600; cursor:pointer; transition:all 0.3s; font-size:14px; display:inline-flex; align-items:center; gap:8px; position: relative; overflow: hidden; }
    .btn:before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s; }
    .btn:hover:before { left: 100%; }
    .btn-primary { background:linear-gradient(135deg, var(--secondary), var(--accent)); color:#fff; box-shadow: 0 4px 12px rgba(255,107,53,0.3); }
    .btn-primary:hover { background:linear-gradient(135deg, var(--accent), var(--secondary)); transform:translateY(-2px); box-shadow: 0 6px 20px rgba(255,107,53,0.4); }
    .btn-success { background:linear-gradient(135deg, #28a745, #20c997); color:#fff; box-shadow: 0 4px 12px rgba(40,167,69,0.3); }
    .btn-success:hover { transform:translateY(-2px); box-shadow: 0 6px 20px rgba(40,167,69,0.4); }
    .btn-danger { background:linear-gradient(135deg, #dc3545, #e83e8c); color:#fff; box-shadow: 0 4px 12px rgba(220,53,69,0.3); }
    .btn-danger:hover { transform:translateY(-2px); box-shadow: 0 6px 20px rgba(220,53,69,0.4); }
    .btn-warning { background:linear-gradient(135deg, #ffc107, #fd7e14); color:#fff; box-shadow: 0 4px 12px rgba(255,193,7,0.3); }
    .btn-warning:hover { transform:translateY(-2px); box-shadow: 0 6px 20px rgba(255,193,7,0.4); }
    .btn-muted { background:#f8f9fa; color:#495057; border:1px solid #e9ecef; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
    .btn-muted:hover { background:#e9ecef; transform:translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    
    /* Tabs */
    .tabs { display:flex; border-bottom:2px solid #e9ecef; margin-bottom:24px; }
    .tab { padding:12px 24px; cursor:pointer; border-bottom:2px solid transparent; margin-bottom:-2px; font-weight:600; color:#6c757d; transition:all 0.3s; position: relative; }
    .tab:after { content: ''; position: absolute; bottom: -2px; left: 50%; width: 0; height: 2px; background: var(--secondary); transition: all 0.3s; transform: translateX(-50%); }
    .tab:hover:after, .tab.active:after { width: 100%; }
    .tab.active { color:var(--secondary); }
    
    /* Charts Container */
    .charts-grid { display:grid; grid-template-columns:2fr 1fr; gap:24px; margin-bottom:30px; }
    .chart-container { background:var(--white); border-radius:16px; padding:24px; box-shadow:0 4px 20px rgba(0,0,0,0.08); border:1px solid #e9ecef; position: relative; overflow: hidden; }
    .chart-container:before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--secondary), var(--accent)); }
    .chart-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; }
    .chart-title { font-size:18px; font-weight:600; color:var(--primary); }
    
    /* Tables Modernizadas */
    .table-container { overflow-x:auto; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    table { width:100%; border-collapse:separate; border-spacing:0; background: var(--white); border-radius: 12px; overflow: hidden; }
    th, td { padding:16px 12px; text-align:left; border-bottom:1px solid #e9ecef; font-size:14px; }
    thead th { background:linear-gradient(135deg, var(--primary), #2a2a2a); color:#fff; font-weight:600; position:sticky; top:0; }
    tbody tr { transition:background 0.3s; }
    tbody tr:hover { background:var(--orange-light); transform: translateX(5px); }
    
    /* Status Badges */
    .status-badge { padding:6px 12px; border-radius:20px; font-size:12px; font-weight:600; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .status-pago { background:linear-gradient(135deg, #d4edda, #c3e6cb); color:#155724; }
    .status-pendente { background:linear-gradient(135deg, #fff3cd, #ffeaa7); color:#856404; }
    .status-agendado { background:linear-gradient(135deg, #cce7ff, #b3d9ff); color:#004085; }
    .status-concluido { background:linear-gradient(135deg, #d1ecf1, #b8e0e6); color:#0c5460; }
    .status-atrasado { background:linear-gradient(135deg, #f8d7da, #f5c6cb); color:#721c24; }
    
    /* Goals Section */
    .goals-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:24px; }
    .goal-card { background:var(--white); border-radius:16px; padding:24px; border-left:4px solid var(--secondary); box-shadow:0 4px 20px rgba(0,0,0,0.08); transition: all 0.3s; }
    .goal-card:hover { transform:translateY(-3px); box-shadow:0 6px 25px rgba(0,0,0,0.12); }
    .goal-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
    .goal-title { font-weight:600; color:var(--primary); }
    .goal-amount { font-size:24px; font-weight:700; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .goal-progress { margin:16px 0; }
    .goal-stats { display:flex; justify-content:space-between; font-size:13px; color:#6c757d; }
    
    /* Filters */
    .filters { background:#f8f9fa; padding:20px; border-radius:12px; margin-bottom:24px; border:1px solid #e9ecef; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .filter-row { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; }
    
    /* Sections */
    .section { display:none; }
    .section.active { display:block; animation: fadeIn 0.5s ease-in-out; }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Config Tabs */
    .config-tab { display:none; }
    .config-tab.active { display:block; animation: fadeIn 0.5s ease-in-out; }
    
    /* Alertas */
    .alert { padding:12px 16px; border-radius:8px; margin-bottom:16px; display:flex; align-items:center; gap:10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .alert-success { background:linear-gradient(135deg, #d4edda, #c3e6cb); color:#155724; border:1px solid #b8e0c6; }
    .alert-error { background:linear-gradient(135deg, #f8d7da, #f5c6cb); color:#721c24; border:1px solid #f1b0b7; }
    
    /* Financial Summary */
    .financial-summary { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-bottom:24px; }
    .financial-card { background:var(--white); border-radius:12px; padding:20px; text-align:center; border:1px solid #e9ecef; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: all 0.3s; position: relative; overflow: hidden; }
    .financial-card:before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; }
    .financial-card.receita:before { background: linear-gradient(90deg, #28a745, #20c997); }
    .financial-card.despesa:before { background: linear-gradient(90deg, #dc3545, #e83e8c); }
    .financial-card.saldo:before { background: linear-gradient(90deg, var(--secondary), var(--accent)); }
    .financial-card:hover { transform:translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.12); }
    .financial-value { font-size:24px; font-weight:700; margin:8px 0; }
    .financial-label { font-size:14px; color:#6c757d; }
    
    /* Floating Action Button */
    .fab { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: linear-gradient(135deg, var(--secondary), var(--accent)); color: white; border-radius: 50%; display: grid; place-items: center; font-size: 20px; box-shadow: 0 6px 20px rgba(255,107,53,0.4); cursor: pointer; transition: all 0.3s; z-index: 1000; }
    .fab:hover { transform: scale(1.1) rotate(90deg); box-shadow: 0 8px 25px rgba(255,107,53,0.6); }
    
    /* Calendar Styles */
    .calendar-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
    .calendar-grid { display:grid; grid-template-columns: repeat(7, minmax(0,1fr)); gap:6px; }
    .day-name { text-align:center; font-weight:700; color:#6c757d; font-size:12px; }
    .day { border:1px solid #e9ecef; border-radius:8px; min-height:54px; display:grid; place-items:center; font-weight:700; cursor:pointer; }
    .day.other { color:#9ca3af; }
    .day.today { background:#eff6ff; border-color:#dbeafe; color:#1d4ed8; }
    .day.has-event { background:#ecfdf5; border-color:#bbf7d0; color:#065f46; }
    
    /* Quick Actions */
    .quick-actions { display:flex; gap:10px; margin:10px 0; }
    
    /* Search Box */
    .search-box { margin-bottom:15px; }
    
    /* RH Styles */
    .employee-card { background:var(--white); border-radius:16px; padding:20px; box-shadow:0 4px 20px rgba(0,0,0,0.08); border:1px solid #e9ecef; margin-bottom:20px; position: relative; overflow: hidden; }
    .employee-card:before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--secondary), var(--accent)); }
    .employee-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; }
    .employee-info { display:flex; align-items:center; gap:15px; }
    .employee-avatar { width:60px; height:60px; border-radius:50%; background:linear-gradient(135deg, var(--secondary), var(--accent)); display:grid; place-items:center; color:white; font-weight:700; font-size:20px; box-shadow: 0 4px 8px rgba(255,107,53,0.3); }
    .employee-details h4 { margin:0; font-size:18px; color:var(--primary); }
    .employee-details p { margin:5px 0 0; color:var(--muted); font-size:14px; }
    .employee-stats { display:grid; grid-template-columns:repeat(auto-fit, minmax(120px, 1fr)); gap:15px; margin-top:15px; }
    .stat-item { text-align:center; padding:10px; background:#f8f9fa; border-radius:8px; }
    .stat-value { font-size:18px; font-weight:700; color:var(--primary); }
    .stat-label { font-size:12px; color:var(--muted); margin-top:5px; }
    .salary-breakdown { margin-top:15px; padding-top:15px; border-top:1px solid #e9ecef; }
    .breakdown-item { display:flex; justify-content:space-between; margin-bottom:8px; }
    .breakdown-label { color:var(--muted); }
    .breakdown-value { font-weight:600; }
    
    @media (max-width: 1024px) {
      .charts-grid { grid-template-columns:1fr; }
      .sidebar { width:80px; }
      .menu span { display:none; }
      .logo h2 span { display:none; }
    }
    
    @media (max-width: 768px) {
      .cards { grid-template-columns:1fr; }
      .header-content { flex-direction:column; gap:15px; align-items:flex-start; }
      .userbox { align-self:flex-end; }
      .financial-summary { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <h2><i class="fa-solid fa-car-side"></i> <span>Flex Vistorias</span></h2>
    </div>
    <ul class="menu">
      <li class="active" onclick="showSection('dashboard', this)"><i class="fa-solid fa-gauge-high"></i><span>Dashboard</span></li>
      <li onclick="showSection('clientes', this)"><i class="fa-solid fa-users"></i><span>Clientes</span></li>
      <li onclick="showSection('servicos', this)"><i class="fa-solid fa-screwdriver-wrench"></i><span>Serviços</span></li>
      <li onclick="showSection('venda', this)"><i class="fa-solid fa-cash-register"></i><span>Nova Venda</span></li>
      <li onclick="showSection('contas-receber', this)"><i class="fa-solid fa-money-bill-wave"></i><span>Contas a Receber</span></li>
      <li onclick="showSection('contas-pagar', this)"><i class="fa-solid fa-credit-card"></i><span>Contas a Pagar</span></li>
      <li onclick="showSection('agendamento', this)"><i class="fa-regular fa-calendar"></i><span>Agendamentos</span></li>
      <li onclick="showSection('categorias', this)"><i class="fa-solid fa-tags"></i><span>Categorias</span></li>
      <li onclick="showSection('usuarios', this)"><i class="fa-solid fa-user-gear"></i><span>Usuários</span></li>
      <li onclick="showSection('rh', this)"><i class="fa-solid fa-id-card"></i><span>Recursos Humanos</span></li>
      <li onclick="showSection('relatorios', this)"><i class="fa-solid fa-chart-column"></i><span>Relatórios</span></li>
      <li onclick="showSection('perfil', this)"><i class="fa-solid fa-user"></i><span>Perfil</span></li>
    </ul>
    <div class="logout">
      <li class="menu" onclick="sair()">
        <div style="display:flex;align-items:center;gap:10px;padding:0;cursor:pointer">
          <i class="fa-solid fa-right-from-bracket"></i><span>Sair</span>
        </div>
      </li>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main">
    <div class="header">
      <div class="header-content">
        <h1 id="page-title">Dashboard</h1>
        <div class="userbox">
          <div class="user-info">
            <div class="user-name" id="user-name">Administrador</div>
            <div class="user-role">Supervisor</div>
          </div>
          <div id="user-avatar" class="avatar">A</div>
        </div>
      </div>
    </div>

    <div class="content">
      <div class="container">
        
        <!-- DASHBOARD -->
        <section id="dashboard" class="section active">
          <!-- Cards Resumo -->
          <div class="cards">
            <div class="card">
              <div class="card-header">
                <h4>Faturamento Mensal</h4>
                <div class="card-icon primary"><i class="fa-solid fa-dollar-sign"></i></div>
              </div>
              <div id="sales-value" class="val">R$ 0,00</div>
              <div class="progress">
                <div id="revenue-progress" class="progress-bar" style="background:linear-gradient(90deg, var(--secondary), var(--accent)); width:0%"></div>
              </div>
              <div class="card-footer">
                <span id="sales-footer">0 vendas</span>
                <span id="revenue-goal">Meta: R$ 10.000</span>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h4>Contas a Receber</h4>
                <div class="card-icon danger"><i class="fa-solid fa-clock"></i></div>
              </div>
              <div id="pending-value" class="val">0</div>
              <div class="progress">
                <div id="pending-progress" class="progress-bar" style="background:linear-gradient(90deg, #dc3545, #e83e8c); width:0%"></div>
              </div>
              <div class="card-footer">
                <span id="pending-footer">A receber</span>
                <span id="pending-amount">R$ 0,00</span>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h4>Total de Clientes</h4>
                <div class="card-icon success"><i class="fa-solid fa-users"></i></div>
              </div>
              <div id="clients-value" class="val">0</div>
              <div class="progress">
                <div id="clients-progress" class="progress-bar" style="background:linear-gradient(90deg, #28a745, #20c997); width:0%"></div>
              </div>
              <div class="card-footer">
                <span>Clientes cadastrados</span>
                <span>Ativos</span>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h4>Serviços Ativos</h4>
                <div class="card-icon info"><i class="fa-solid fa-screwdriver-wrench"></i></div>
              </div>
              <div id="services-value" class="val">0</div>
              <div class="progress">
                <div id="services-progress" class="progress-bar" style="background:linear-gradient(90deg, #17a2b8, #20c997); width:0%"></div>
              </div>
              <div class="card-footer">
                <span>Serviços disponíveis</span>
                <span>Ativos</span>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h4>Agendamentos Hoje</h4>
                <div class="card-icon warning"><i class="fa-regular fa-calendar"></i></div>
              </div>
              <div id="scheduling-value" class="val">0</div>
              <div class="progress">
                <div id="scheduling-progress" class="progress-bar" style="background:linear-gradient(90deg, #ffc107, #fd7e14); width:0%"></div>
              </div>
              <div class="card-footer">
                <span>Para hoje</span>
                <span>Confirmados</span>
              </div>
            </div>
          </div>

          <!-- Gráficos -->
          <div class="charts-grid">
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title">Vendas Mensais</div>
              </div>
              <div style="height:300px"><canvas id="salesChart"></canvas></div>
            </div>
            
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title">Distribuição por Serviço</div>
              </div>
              <div style="height:300px"><canvas id="servicesChart"></canvas></div>
            </div>
          </div>
        </section>

        <!-- CLIENTES -->
        <section id="clientes" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Gerenciamento de Clientes</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Nome completo *</label>
                  <input type="text" id="client-name" placeholder="Nome completo *">
                </div>
                <div class="form-group">
                  <label class="form-label">E-mail</label>
                  <input type="email" id="client-email" placeholder="E-mail">
                </div>
                <div class="form-group">
                  <label class="form-label">Telefone</label>
                  <input type="text" id="client-phone" placeholder="Telefone">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">CPF/CNPJ</label>
                  <input type="text" id="client-document" placeholder="CPF/CNPJ">
                </div>
                <div class="form-group">
                  <label class="form-label">Tipo de Vistoria</label>
                  <select id="client-inspection-type">
                    <option value="">Tipo de Vistoria</option>
                    <option value="1">1 - Vistoria Veicular</option>
                    <option value="2">2 - Vistoria Cautelar</option>
                    <option value="3">3 - Consulta</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="addClient()">
                    <i class="fa-solid fa-plus"></i> Adicionar Cliente
                  </button>
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Buscar Clientes</label>
                  <input type="text" id="search-clients" placeholder="Buscar clientes..." oninput="searchClients()">
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Telefone</th>
                    <th>Documento</th>
                    <th>Tipo Vistoria</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="clients-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SERVIÇOS -->
        <section id="servicos" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Gerenciamento de Serviços</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Código</label>
                  <input type="text" id="service-code" placeholder="Código (ex: 001, 002)">
                </div>
                <div class="form-group">
                  <label class="form-label">Nome do serviço *</label>
                  <input type="text" id="service-name" placeholder="Nome do serviço *">
                </div>
                <div class="form-group">
                  <label class="form-label">Preço (R$) *</label>
                  <input type="number" id="service-price" step="0.01" placeholder="Preço (R$) *">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Custo (R$) *</label>
                  <input type="number" id="service-cost" step="0.01" placeholder="Custo (R$) *">
                </div>
                <div class="form-group">
                  <label class="form-label">Duração (min)</label>
                  <input type="number" id="service-duration" placeholder="Duração (min)">
                </div>
                <div class="form-group">
                  <label class="form-label">Categoria</label>
                  <select id="service-category"></select>
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="addService()">
                    <i class="fa-solid fa-plus"></i> Adicionar Serviço
                  </button>
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Buscar Serviços</label>
                  <input type="text" id="search-services" placeholder="Buscar serviços..." oninput="searchServices()">
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Código</th>
                    <th>Nome</th>
                    <th>Preço</th>
                    <th>Custo</th>
                    <th>Duração</th>
                    <th>Categoria</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="services-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- NOVA VENDA -->
        <section id="venda" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Nova Venda</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Cliente *</label>
                  <select id="sale-client"></select>
                </div>
                <div class="form-group">
                  <label class="form-label">Serviço *</label>
                  <select id="sale-service"></select>
                </div>
                <div class="form-group">
                  <label class="form-label">Veículo *</label>
                  <input type="text" id="sale-vehicle" placeholder="Veículo *">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Placa *</label>
                  <input type="text" id="sale-plate" placeholder="Placa *">
                </div>
                <div class="form-group">
                  <label class="form-label">Data</label>
                  <input type="date" id="sale-date">
                </div>
                <div class="form-group">
                  <label class="form-label">Forma de Pagamento</label>
                  <select id="sale-payment">
                    <option value="dinheiro">Dinheiro</option>
                    <option value="cartao_credito">Cartão de Crédito</option>
                    <option value="cartao_debito">Cartão de Débito</option>
                    <option value="pix">PIX</option>
                  </select>
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Status</label>
                  <select id="sale-status">
                    <option value="Pago">Pago</option>
                    <option value="Pendente" selected>Pendente</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">Desconto (R$)</label>
                  <input type="number" id="sale-discount" step="0.01" placeholder="Desconto (R$)">
                </div>
                <div class="form-group">
                  <label class="form-label">Observações</label>
                  <input type="text" id="sale-notes" placeholder="Observações">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <button class="btn btn-success" onclick="completeSale()">
                    <i class="fa-solid fa-cash-register"></i> Finalizar Venda
                  </button>
                  <button class="btn btn-muted" onclick="clearSaleForm()" style="margin-left:10px;">
                    <i class="fa-solid fa-broom"></i> Nova Venda
                  </button>
                </div>
              </div>
            </div>
            
            <div id="sale-summary" class="panel" style="margin-top:12px; display:none;">
              <div class="panel-header">
                <h3>Resumo da Última Venda</h3>
              </div>
              <div class="row">
                <div class="form-group">
                  <label class="form-label">Cliente</label>
                  <div id="summary-client"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Serviço</label>
                  <div id="summary-service"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Veículo</label>
                  <div id="summary-vehicle"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Placa</label>
                  <div id="summary-plate"></div>
                </div>
              </div>
              <div class="row">
                <div class="form-group">
                  <label class="form-label">Data</label>
                  <div id="summary-date"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Pagamento</label>
                  <div id="summary-payment"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Status</label>
                  <div id="summary-status"></div>
                </div>
                <div class="form-group">
                  <label class="form-label">Desconto</label>
                  <div id="summary-discount"></div>
                </div>
              </div>
              <div class="form-group">
                <label class="form-label">Observações</label>
                <div id="summary-notes"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- CONTAS A RECEBER -->
        <section id="contas-receber" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Contas a Receber</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Buscar por cliente</label>
                  <input type="text" id="search-bills-client" placeholder="Buscar por cliente...">
                </div>
                <div class="form-group">
                  <label class="form-label">Buscar por veículo</label>
                  <input type="text" id="search-bills-vehicle" placeholder="Buscar por veículo...">
                </div>
                <div class="form-group">
                  <label class="form-label">Buscar por placa</label>
                  <input type="text" id="search-bills-plate" placeholder="Buscar por placa...">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Data início</label>
                  <input type="date" id="search-bills-date-start">
                </div>
                <div class="form-group">
                  <label class="form-label">Data fim</label>
                  <input type="date" id="search-bills-date-end">
                </div>
                <div class="form-group">
                  <label class="form-label">Status</label>
                  <select id="search-bills-status">
                    <option value="">Todos os status</option>
                    <option value="Pago">Pago</option>
                    <option value="Pendente">Pendente</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="searchBills()">Buscar</button>
                  <button class="btn btn-muted" onclick="clearBillSearch()" style="margin-left:10px;">Limpar</button>
                </div>
              </div>
            </div>
            
            <div class="quick-actions">
              <button class="btn btn-success" onclick="receiveSelectedBills()">
                <i class="fa-solid fa-check"></i> Receber selecionadas
              </button>
              <button class="btn btn-warning" onclick="selectAllBills()">
                <i class="fa-solid fa-check-double"></i> Selecionar todas
              </button>
              <button class="btn btn-muted" onclick="deselectAllBills()">
                <i class="fa-solid fa-times"></i> Desmarcar todas
              </button>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th width="30"><input type="checkbox" id="select-all-bills" onchange="toggleSelectAllBills(this)"></th>
                    <th>Venda</th>
                    <th>Cliente</th>
                    <th>Veículo</th>
                    <th>Placa</th>
                    <th>Serviço</th>
                    <th>Data</th>
                    <th>Valor</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="bills-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- CONTAS A PAGAR -->
        <section id="contas-pagar" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Gerenciamento de Contas a Pagar</h3>
              <div class="panel-actions">
                <button class="btn btn-success" onclick="showPayableForm()">
                  <i class="fa-solid fa-plus"></i> Nova Despesa
                </button>
              </div>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Descrição</th>
                    <th>Fornecedor</th>
                    <th>Valor</th>
                    <th>Vencimento</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="payables-table-body"></tbody>
              </table>
            </div>
          </div>
          
          <!-- Formulário de Despesa -->
          <div id="payable-form-container" class="panel" style="display:none;">
            <div class="panel-header">
              <h3 id="payable-form-title">Nova Despesa</h3>
              <button class="btn btn-muted" onclick="hidePayableForm()">
                <i class="fa-solid fa-times"></i> Cancelar
              </button>
            </div>
            
            <form id="payable-form" onsubmit="savePayable(event)">
              <div class="row">
                <div class="form-group">
                  <label class="form-label">Descrição *</label>
                  <input type="text" id="payable-description" required>
                </div>
                <div class="form-group">
                  <label class="form-label">Fornecedor</label>
                  <input type="text" id="payable-supplier">
                </div>
              </div>
              
              <div class="row">
                <div class="form-group">
                  <label class="form-label">Valor (R$) *</label>
                  <input type="number" id="payable-value" step="0.01" required>
                </div>
                <div class="form-group">
                  <label class="form-label">Data de Vencimento *</label>
                  <input type="date" id="payable-due-date" required>
                </div>
              </div>
              
              <div class="form-group">
                <label class="form-label">Observações</label>
                <textarea id="payable-notes" rows="3"></textarea>
              </div>
              
              <button type="submit" class="btn btn-success">
                <i class="fa-solid fa-save"></i> Salvar Despesa
              </button>
            </form>
          </div>
        </section>

        <!-- AGENDAMENTOS -->
        <section id="agendamento" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Agendamentos</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Cliente</label>
                  <select id="scheduling-client"></select>
                </div>
                <div class="form-group">
                  <label class="form-label">Serviço</label>
                  <select id="scheduling-service"></select>
                </div>
                <div class="form-group">
                  <label class="form-label">Data</label>
                  <input type="date" id="scheduling-date">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Hora</label>
                  <input type="time" id="scheduling-time">
                </div>
                <div class="form-group">
                  <label class="form-label">Observações</label>
                  <input type="text" id="scheduling-notes" placeholder="Observações">
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="addScheduling()">
                    <i class="fa-solid fa-plus"></i> Agendar
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="panel" style="margin-top:12px;">
            <div class="calendar-head">
              <button class="btn btn-muted" onclick="prevMonth()"><i class="fa-solid fa-chevron-left"></i></button>
              <div id="current-month" style="font-weight:800"></div>
              <button class="btn btn-muted" onclick="nextMonth()"><i class="fa-solid fa-chevron-right"></i></button>
            </div>
            <div class="calendar-grid" id="calendar-weekdays">
              <div class="day-name">Dom</div><div class="day-name">Seg</div><div class="day-name">Ter</div><div class="day-name">Qua</div><div class="day-name">Qui</div><div class="day-name">Sex</div><div class="day-name">Sáb</div>
            </div>
            <div class="calendar-grid" id="calendar-days"></div>
          </div>

          <div class="panel" style="margin-top:12px;">
            <div class="search-box">
              <div class="row">
                <input id="search-scheduling" placeholder="Buscar agendamentos por cliente, serviço ou observações..." oninput="searchScheduling()">
              </div>
            </div>
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Cliente</th>
                    <th>Serviço</th>
                    <th>Data/Hora</th>
                    <th>Observações</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="scheduling-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- CATEGORIAS -->
        <section id="categorias" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Categorias</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Nome da categoria</label>
                  <input type="text" id="category-name" placeholder="Nome da categoria">
                </div>
                <div class="form-group">
                  <label class="form-label">Descrição (opcional)</label>
                  <input type="text" id="category-description" placeholder="Descrição (opcional)">
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="addCategory()">
                    <i class="fa-solid fa-plus"></i> Adicionar
                  </button>
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Nome</th>
                    <th>Descrição</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="categories-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- USUÁRIOS -->
        <section id="usuarios" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Usuários</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Nome</label>
                  <input type="text" id="user-name-input" placeholder="Nome">
                </div>
                <div class="form-group">
                  <label class="form-label">E-mail</label>
                  <input type="email" id="user-email" placeholder="E-mail">
                </div>
                <div class="form-group">
                  <label class="form-label">Senha</label>
                  <input type="password" id="user-password" placeholder="Senha">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Perfil</label>
                  <select id="user-role">
                    <option value="admin">Administrador</option>
                    <option value="manager">Gerente</option>
                    <option value="attendant">Atendente</option>
                    <option value="viewer">Visualizador</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="addUser()">
                    <i class="fa-solid fa-plus"></i> Adicionar
                  </button>
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Nome</th>
                    <th>E-mail</th>
                    <th>Perfil</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="users-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- RECURSOS HUMANOS -->
        <section id="rh" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Recursos Humanos - Gerenciamento de Funcionários</h3>
              <div class="panel-actions">
                <button class="btn btn-success" onclick="showEmployeeForm()">
                  <i class="fa-solid fa-plus"></i> Novo Funcionário
                </button>
              </div>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Buscar funcionário</label>
                  <input type="text" id="search-employee" placeholder="Buscar por nome, cargo ou departamento..." oninput="searchEmployees()">
                </div>
                <div class="form-group">
                  <label class="form-label">Departamento</label>
                  <select id="filter-department" onchange="filterEmployees()">
                    <option value="">Todos os departamentos</option>
                    <option value="Administrativo">Administrativo</option>
                    <option value="Vistorias">Vistorias</option>
                    <option value="Atendimento">Atendimento</option>
                    <option value="Financeiro">Financeiro</option>
                    <option value="TI">TI</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">Status</label>
                  <select id="filter-status" onchange="filterEmployees()">
                    <option value="">Todos os status</option>
                    <option value="Ativo">Ativo</option>
                    <option value="Férias">Férias</option>
                    <option value="Afastado">Afastado</option>
                    <option value="Inativo">Inativo</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Cards de Funcionários -->
          <div id="employees-container" class="cards">
            <!-- Os cards dos funcionários serão gerados dinamicamente aqui -->
          </div>
          
          <!-- Formulário de Funcionário -->
          <div id="employee-form-container" class="panel" style="display:none;">
            <div class="panel-header">
              <h3 id="employee-form-title">Novo Funcionário</h3>
              <button class="btn btn-muted" onclick="hideEmployeeForm()">
                <i class="fa-solid fa-times"></i> Cancelar
              </button>
            </div>
            
            <form id="employee-form" onsubmit="saveEmployee(event)">
              <div class="tabs">
                <div class="tab active" onclick="showEmployeeTab('dados-pessoais', this)">Dados Pessoais</div>
                <div class="tab" onclick="showEmployeeTab('dados-profissionais', this)">Dados Profissionais</div>
                <div class="tab" onclick="showEmployeeTab('beneficios', this)">Benefícios</div>
              </div>
              
              <!-- Dados Pessoais -->
              <div id="dados-pessoais" class="config-tab active">
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Nome Completo *</label>
                    <input type="text" id="employee-name" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">CPF *</label>
                    <input type="text" id="employee-cpf" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">RG *</label>
                    <input type="text" id="employee-rg" required>
                  </div>
                </div>
                
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Data de Nascimento *</label>
                    <input type="date" id="employee-birthdate" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Gênero</label>
                    <select id="employee-gender">
                      <option value="Masculino">Masculino</option>
                      <option value="Feminino">Feminino</option>
                      <option value="Outro">Outro</option>
                      <option value="Prefiro não informar">Prefiro não informar</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Estado Civil</label>
                    <select id="employee-marital-status">
                      <option value="Solteiro(a)">Solteiro(a)</option>
                      <option value="Casado(a)">Casado(a)</option>
                      <option value="Divorciado(a)">Divorciado(a)</option>
                      <option value="Viúvo(a)">Viúvo(a)</option>
                    </select>
                  </div>
                </div>
                
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Telefone *</label>
                    <input type="text" id="employee-phone" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">E-mail *</label>
                    <input type="email" id="employee-email" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Endereço</label>
                    <input type="text" id="employee-address">
                  </div>
                </div>
              </div>
              
              <!-- Dados Profissionais -->
              <div id="dados-profissionais" class="config-tab">
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Cargo *</label>
                    <input type="text" id="employee-position" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Departamento *</label>
                    <select id="employee-department" required>
                      <option value="">Selecione...</option>
                      <option value="Administrativo">Administrativo</option>
                      <option value="Vistorias">Vistorias</option>
                      <option value="Atendimento">Atendimento</option>
                      <option value="Financeiro">Financeiro</option>
                      <option value="TI">TI</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Data de Admissão *</label>
                    <input type="date" id="employee-hire-date" required>
                  </div>
                </div>
                
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Salário Base (R$) *</label>
                    <input type="number" id="employee-base-salary" step="0.01" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Tipo de Contrato</label>
                    <select id="employee-contract-type">
                      <option value="CLT">CLT</option>
                      <option value="PJ">PJ</option>
                      <option value="Estágio">Estágio</option>
                      <option value="Temporário">Temporário</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Jornada de Trabalho (h/semana)</label>
                    <input type="number" id="employee-work-hours" value="44">
                  </div>
                </div>
                
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Status</label>
                    <select id="employee-status">
                      <option value="Ativo">Ativo</option>
                      <option value="Férias">Férias</option>
                      <option value="Afastado">Afastado</option>
                      <option value="Inativo">Inativo</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <!-- Benefícios -->
              <div id="beneficios" class="config-tab">
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Vale Transporte (R$)</label>
                    <input type="number" id="employee-transport-allowance" step="0.01">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Vale Refeição (R$)</label>
                    <input type="number" id="employee-meal-allowance" step="0.01">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Vale Alimentação (R$)</label>
                    <input type="number" id="employee-food-allowance" step="0.01">
                  </div>
                </div>
                
                <div class="row">
                  <div class="form-group">
                    <label class="form-label">Plano de Saúde (R$)</label>
                    <input type="number" id="employee-health-insurance" step="0.01">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Outros Benefícios (R$)</label>
                    <input type="number" id="employee-other-benefits" step="0.01">
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Observações</label>
                  <textarea id="employee-notes" rows="3"></textarea>
                </div>
              </div>
              
              <button type="submit" class="btn btn-success">
                <i class="fa-solid fa-save"></i> Salvar Funcionário
              </button>
            </form>
          </div>
        </section>

        <!-- RELATÓRIOS -->
        <section id="relatorios" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Relatório de Vendas</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Data início</label>
                  <input type="date" id="report-sales-date-start">
                </div>
                <div class="form-group">
                  <label class="form-label">Data fim</label>
                  <input type="date" id="report-sales-date-end">
                </div>
                <div class="form-group">
                  <label class="form-label">Cliente</label>
                  <select id="report-sales-client">
                    <option value="">Todos os clientes</option>
                  </select>
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Serviço</label>
                  <select id="report-sales-service">
                    <option value="">Todos os serviços</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">Status</label>
                  <select id="report-sales-status">
                    <option value="">Todos os status</option>
                    <option value="Pago">Pago</option>
                    <option value="Pendente">Pendente</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="generateSalesReport()">
                    <i class="fa-solid fa-chart-line"></i> Gerar Relatório
                  </button>
                  <button class="btn btn-muted" onclick="window.print()" style="margin-left:10px;">
                    <i class="fa-solid fa-print"></i> Imprimir
                  </button>
                  <button class="btn btn-success" onclick="exportToExcel()" style="margin-left:10px;">
                    <i class="fa-solid fa-file-excel"></i> Exportar Excel
                  </button>
                </div>
              </div>
            </div>
            
            <div style="height:260px; margin-top:20px;">
              <canvas id="salesReportChart"></canvas>
            </div>
            
            <div class="table-container" style="margin-top:20px">
              <table>
                <thead>
                  <tr>
                    <th>Data</th>
                    <th>Cliente</th>
                    <th>Veículo</th>
                    <th>Placa</th>
                    <th>Serviço</th>
                    <th>Valor</th>
                    <th>Status</th>
                    <th>Pagamento</th>
                  </tr>
                </thead>
                <tbody id="sales-report-body"></tbody>
              </table>
            </div>
            
            <div style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:8px;">
              <h4>Resumo do Relatório</h4>
              <div class="row">
                <div class="form-group">
                  <label class="form-label">Total de Vendas</label>
                  <div id="report-total-sales">0</div>
                </div>
                <div class="form-group">
                  <label class="form-label">Valor Total</label>
                  <div id="report-total-value">R$ 0,00</div>
                </div>
                <div class="form-group">
                  <label class="form-label">Valor Pendente</label>
                  <div id="report-pending-value">R$ 0,00</div>
                </div>
                <div class="form-group">
                  <label class="form-label">Valor Recebido</label>
                  <div id="report-received-value">R$ 0,00</div>
                </div>
                <div class="form-group">
                  <label class="form-label">Ticket Médio</label>
                  <div id="report-average-ticket">R$ 0,00</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- PERFIL -->
        <section id="perfil" class="section">
          <div class="panel">
            <div class="panel-header">
              <h3>Meu Perfil</h3>
            </div>
            
            <div class="filters">
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Nome</label>
                  <input type="text" id="profile-name" placeholder="Nome">
                </div>
                <div class="form-group">
                  <label class="form-label">E-mail</label>
                  <input type="email" id="profile-email" placeholder="E-mail">
                </div>
                <div class="form-group">
                  <label class="form-label">Telefone</label>
                  <input type="text" id="profile-phone" placeholder="Telefone">
                </div>
              </div>
              
              <div class="filter-row">
                <div class="form-group">
                  <label class="form-label">Nova senha (opcional)</label>
                  <input type="password" id="profile-password" placeholder="Nova senha (opcional)">
                </div>
                <div class="form-group">
                  <label class="form-label">Confirmar nova senha</label>
                  <input type="password" id="profile-password-confirm" placeholder="Confirmar nova senha">
                </div>
                <div class="form-group">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary" onclick="updateProfile()">
                    <i class="fa-solid fa-save"></i> Salvar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Floating Action Button -->
        <div class="fab" onclick="scrollToTop()">
          <i class="fa-solid fa-chevron-up"></i>
        </div>

      </div>
    </div>
  </main>

  <script>
    // ========== VARIÁVEIS GLOBAIS ==========
    // Dados em memória - funciona localmente
    let clients = [];
    let services = [];
    let categories = [];
    let sales = [];
    let users = [{ id:1, name:"Administrador", email:"admin@flexvistorias.com", password:"admin123", role:"admin", phone:"(11) 99999-9999" }];
    let schedulings = [];
    let payables = [];
    let employees = [];
    let currentUser = users[0];
    let currentDate = new Date();
    let salesChart = null;
    let lastSaleId = null;
    let cashFlowChart = null;
    let servicesChart = null;
    let currentEmployeeId = null;

    // ========== FUNÇÕES UTILITÁRIAS ==========
    function byId(id) {
      return document.getElementById(id);
    }

    function currency(value) {
      return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);
    }

    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('pt-BR');
    }

    function todayISO() {
      return new Date().toISOString().split('T')[0];
    }

    function generateId() {
      return Date.now();
    }

    function showAlert(message, type = 'success') {
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.innerHTML = `
        <i class="fa-solid fa-${type === 'success' ? 'check' : 'exclamation-triangle'}"></i>
        ${message}
      `;
      
      document.querySelector('.content').insertBefore(alert, document.querySelector('.container'));
      
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ========== NAVEGAÇÃO E INTERFACE ==========
    function showSection(sectionId, element = null) {
      // Esconder todas as seções
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Mostrar a seção selecionada
      byId(sectionId).classList.add('active');
      
      // Atualizar título da página
      const titles = {
        dashboard: 'Dashboard',
        clientes: 'Clientes',
        servicos: 'Serviços',
        venda: 'Nova Venda',
        'contas-receber': 'Contas a Receber',
        'contas-pagar': 'Contas a Pagar',
        agendamento: 'Agendamentos',
        categorias: 'Categorias',
        usuarios: 'Usuários',
        rh: 'Recursos Humanos',
        relatorios: 'Relatórios',
        perfil: 'Perfil'
      };
      
      byId('page-title').textContent = titles[sectionId] || 'Flex Vistorias';
      
      // Atualizar menu ativo
      if (element) {
        document.querySelectorAll('.menu li').forEach(li => {
          li.classList.remove('active');
        });
        element.classList.add('active');
      }
      
      // Atualizar dados da seção
      if (sectionId === 'dashboard') {
        updateDashboard();
      } else if (sectionId === 'clientes') {
        loadClientsTable();
      } else if (sectionId === 'servicos') {
        loadCategoriesForServices();
        loadServicesTable();
      } else if (sectionId === 'venda') {
        loadClientsForSale();
        loadServicesForSale();
        clearSaleForm();
      } else if (sectionId === 'contas-receber') {
        loadBills();
      } else if (sectionId === 'contas-pagar') {
        loadPayablesTable();
      } else if (sectionId === 'agendamento') {
        loadSchedulingFormOptions();
        loadSchedulingCalendar();
        loadSchedulingTable();
      } else if (sectionId === 'categorias') {
        loadCategoriesTable();
      } else if (sectionId === 'usuarios') {
        loadUsersTable();
      } else if (sectionId === 'rh') {
        loadEmployees();
      } else if (sectionId === 'relatorios') {
        loadReportFilters();
        generateSalesReport();
      } else if (sectionId === 'perfil') {
        fillProfile();
      }
    }

    function sair() {
      if (confirm('Tem certeza que deseja sair do sistema?')) {
        alert('Sistema encerrado. Recarregue a página para continuar.');
      }
    }

    // ========== DASHBOARD ==========
    function updateDashboard() {
      const totalSales = sales.reduce((t,s)=>{
        const svc = services.find(x=>x.id===s.serviceId);
        return t + (svc ? parseFloat(svc.price) : 0);
      },0);
      
      const pendingBills = sales.filter(s=>s.status!=='Pago').length;
      const todaySchedulings = schedulings.filter(s=>{
        const d = new Date(s.date);
        const t = new Date();
        return d.toDateString() === t.toDateString();
      }).length;

      byId('sales-value').textContent = currency(totalSales);
      byId('sales-footer').textContent = `${sales.length} vendas`;
      byId('pending-value').textContent = pendingBills;
      byId('clients-value').textContent = clients.length;
      byId('services-value').textContent = services.length;
      byId('scheduling-value').textContent = todaySchedulings;

      updateSalesChart();
      updateServicesChart();
    }

    function updateSalesChart() {
      const ctx = byId('salesChart').getContext('2d');
      const monthTotals = Array(12).fill(0);
      
      sales.forEach(s=>{
        const d = new Date(s.date); 
        const svc = services.find(x=>x.id===s.serviceId);
        if(!isNaN(d) && svc) monthTotals[d.getMonth()] += parseFloat(svc.price||0);
      });
      
      if(salesChart) salesChart.destroy();
      
      salesChart = new Chart(ctx, {
        type:'line',
        data:{ 
          labels:['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'],
          datasets:[{ 
            data:monthTotals, 
            borderColor:'#ff6b35', 
            backgroundColor:'rgba(255,107,53,.15)', 
            fill:true, 
            tension:.3 
          }] 
        },
        options:{ 
          responsive:true, 
          plugins:{ legend:{display:false} }, 
          scales:{ y:{ beginAtZero:true } } 
        }
      });
    }

    function updateServicesChart() {
      const ctx = byId('servicesChart').getContext('2d');
      const serviceCounts = {};
      
      sales.forEach(sale => {
        const service = services.find(s => s.id === sale.serviceId);
        if (service) {
          serviceCounts[service.name] = (serviceCounts[service.name] || 0) + 1;
        }
      });

      const labels = Object.keys(serviceCounts);
      const data = Object.values(serviceCounts);

      if (servicesChart) servicesChart.destroy();
      
      servicesChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: ['#ff6b35', '#28a745', '#ffc107', '#6f42c1', '#dc3545', '#17a2b8'],
            borderWidth: 3,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }

    // ========== CLIENTES ==========
    function addClient(){
      const name = byId('client-name').value.trim();
      const email = byId('client-email').value.trim();
      const phone = byId('client-phone').value.trim();
      const document = byId('client-document').value.trim();
      const inspectionType = byId('client-inspection-type').value;
      
      if(!name) return alert('Informe o nome do cliente');
      
      const newClient = { 
        id: generateId(), 
        name, 
        email, 
        phone, 
        document, 
        inspectionType,
        createdAt: new Date().toISOString() 
      };
      
      clients.push(newClient);
      
      // Limpar campos
      byId('client-name').value = '';
      byId('client-email').value = '';
      byId('client-phone').value = '';
      byId('client-document').value = '';
      byId('client-inspection-type').selectedIndex = 0;
      
      loadClientsTable();
      updateDashboard();
      showAlert('Cliente adicionado com sucesso!');
    }

    function loadClientsTable() {
      const tbody = byId('clients-table-body');
      tbody.innerHTML = '';
      
      clients.forEach(client => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${client.name}</td>
          <td>${client.email || '-'}</td>
          <td>${client.phone || '-'}</td>
          <td>${client.document || '-'}</td>
          <td>${client.inspectionType || '-'}</td>
          <td>
            <button class="btn btn-muted" onclick="editClient(${client.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteClient(${client.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function searchClients(){
      const query = byId('search-clients').value.toLowerCase().trim();
      
      if(!query){
        loadClientsTable();
        return;
      }
      
      const filtered = clients.filter(client => 
        client.name.toLowerCase().includes(query) ||
        (client.email && client.email.toLowerCase().includes(query)) ||
        (client.phone && client.phone.toLowerCase().includes(query)) ||
        (client.document && client.document.toLowerCase().includes(query))
      );
      
      const tbody = byId('clients-table-body');
      tbody.innerHTML = '';
      
      filtered.forEach(client => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${client.name}</td>
          <td>${client.email || '-'}</td>
          <td>${client.phone || '-'}</td>
          <td>${client.document || '-'}</td>
          <td>${client.inspectionType || '-'}</td>
          <td>
            <button class="btn btn-muted" onclick="editClient(${client.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteClient(${client.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function editClient(clientId) {
      const client = clients.find(c => c.id === clientId);
      if (client) {
        byId('client-name').value = client.name;
        byId('client-email').value = client.email || '';
        byId('client-phone').value = client.phone || '';
        byId('client-document').value = client.document || '';
        byId('client-inspection-type').value = client.inspectionType || '';
        
        // Remover o cliente da lista para depois adicionar atualizado
        clients = clients.filter(c => c.id !== clientId);
        showAlert('Preencha os dados e clique em Adicionar para atualizar o cliente');
      }
    }

    function deleteClient(clientId) {
      if (confirm('Tem certeza que deseja excluir este cliente?')) {
        clients = clients.filter(c => c.id !== clientId);
        loadClientsTable();
        showAlert('Cliente excluído com sucesso!');
        updateDashboard();
      }
    }

    // ========== SERVIÇOS ==========
    function loadCategoriesForServices(){
      const select = byId('service-category');
      select.innerHTML = '<option value="">Selecione uma categoria</option>';
      
      categories.forEach(cat => {
        const option = document.createElement('option');
        option.value = cat.id;
        option.textContent = cat.name;
        select.appendChild(option);
      });
    }

    function addService(){
      const code = byId('service-code').value.trim();
      const name = byId('service-name').value.trim();
      const price = parseFloat(byId('service-price').value);
      const cost = parseFloat(byId('service-cost').value);
      const duration = parseInt(byId('service-duration').value) || null;
      const categoryId = byId('service-category').value || null;
      
      if(!name || isNaN(price) || isNaN(cost)) {
        return alert('Preencha nome, preço e custo do serviço');
      }
      
      const newService = {
        id: generateId(),
        code,
        name,
        price,
        cost,
        duration,
        categoryId,
        createdAt: new Date().toISOString()
      };
      
      services.push(newService);
      
      // Limpar campos
      byId('service-code').value = '';
      byId('service-name').value = '';
      byId('service-price').value = '';
      byId('service-cost').value = '';
      byId('service-duration').value = '';
      byId('service-category').selectedIndex = 0;
      
      loadServicesTable();
      updateDashboard();
      showAlert('Serviço adicionado com sucesso!');
    }

    function loadServicesTable() {
      const tbody = byId('services-table-body');
      tbody.innerHTML = '';
      
      services.forEach(service => {
        const category = categories.find(c => c.id === service.categoryId);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${service.code || '-'}</td>
          <td>${service.name}</td>
          <td>${currency(service.price)}</td>
          <td>${currency(service.cost)}</td>
          <td>${service.duration ? service.duration + 'min' : '-'}</td>
          <td>${category ? category.name : 'Sem categoria'}</td>
          <td>
            <button class="btn btn-muted" onclick="editService(${service.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteService(${service.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function searchServices(){
      const query = byId('search-services').value.toLowerCase().trim();
      
      if(!query){
        loadServicesTable();
        return;
      }
      
      const filtered = services.filter(service => 
        service.name.toLowerCase().includes(query) ||
        (service.code && service.code.toLowerCase().includes(query))
      );
      
      const tbody = byId('services-table-body');
      tbody.innerHTML = '';
      
      filtered.forEach(service => {
        const category = categories.find(c => c.id === service.categoryId);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${service.code || '-'}</td>
          <td>${service.name}</td>
          <td>${currency(service.price)}</td>
          <td>${currency(service.cost)}</td>
          <td>${service.duration ? service.duration + 'min' : '-'}</td>
          <td>${category ? category.name : 'Sem categoria'}</td>
          <td>
            <button class="btn btn-muted" onclick="editService(${service.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteService(${service.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function editService(serviceId) {
      const service = services.find(s => s.id === serviceId);
      if (service) {
        byId('service-code').value = service.code || '';
        byId('service-name').value = service.name;
        byId('service-price').value = service.price;
        byId('service-cost').value = service.cost;
        byId('service-duration').value = service.duration || '';
        byId('service-category').value = service.categoryId || '';
        
        // Remover o serviço da lista para depois adicionar atualizado
        services = services.filter(s => s.id !== serviceId);
        showAlert('Preencha os dados e clique em Adicionar para atualizar o serviço');
      }
    }

    function deleteService(serviceId) {
      if (confirm('Tem certeza que deseja excluir este serviço?')) {
        services = services.filter(s => s.id !== serviceId);
        loadServicesTable();
        showAlert('Serviço excluído com sucesso!');
        updateDashboard();
      }
    }

    // ========== NOVA VENDA ==========
    function loadClientsForSale(){
      const select = byId('sale-client');
      select.innerHTML = '<option value="">Selecione um cliente</option>';
      
      clients.forEach(client => {
        const option = document.createElement('option');
        option.value = client.id;
        option.textContent = client.name;
        select.appendChild(option);
      });
    }

    function loadServicesForSale(){
      const select = byId('sale-service');
      select.innerHTML = '<option value="">Selecione um serviço</option>';
      
      services.forEach(service => {
        const option = document.createElement('option');
        option.value = service.id;
        option.textContent = `${service.name} - ${currency(service.price)}`;
        select.appendChild(option);
      });
    }

    function clearSaleForm(){
      byId('sale-client').selectedIndex = 0;
      byId('sale-service').selectedIndex = 0;
      byId('sale-vehicle').value = '';
      byId('sale-plate').value = '';
      byId('sale-date').value = todayISO();
      byId('sale-payment').selectedIndex = 0;
      byId('sale-status').selectedIndex = 1; // Pendente
      byId('sale-discount').value = '';
      byId('sale-notes').value = '';
      lastSaleId = null;
    }

    function completeSale(){
      // Prevenir duplicação de vendas
      const currentTimestamp = Date.now();
      if(lastSaleId && (currentTimestamp - lastSaleId) < 3000) {
        return alert('Aguarde alguns segundos antes de fazer outra venda!');
      }

      const clientId = parseInt(byId('sale-client').value);
      const serviceId = parseInt(byId('sale-service').value);
      const vehicle = byId('sale-vehicle').value.trim();
      const plate = byId('sale-plate').value.trim();
      const date = byId('sale-date').value || todayISO();
      const payment = byId('sale-payment').value;
      const status = byId('sale-status').value;
      const discount = parseFloat(byId('sale-discount').value) || 0;
      const notes = byId('sale-notes').value.trim();
      
      // Validações reforçadas
      if(!clientId || !serviceId) {
        return alert('Selecione um cliente e um serviço');
      }
      
      if(!vehicle || !plate) {
        return alert('Informe o veículo e a placa');
      }
      
      const service = services.find(s => s.id === serviceId);
      if(!service) return alert('Serviço não encontrado');
      
      const total = service.price - discount;
      
      const newSale = {
        id: currentTimestamp,
        clientId,
        serviceId,
        vehicle,
        plate,
        date,
        payment,
        status,
        discount,
        total,
        notes,
        createdAt: new Date().toISOString()
      };
      
      sales.push(newSale);
      lastSaleId = currentTimestamp;
      
      // Mostrar resumo
      const client = clients.find(c => c.id === clientId);
      byId('summary-client').textContent = client.name;
      byId('summary-service').textContent = `${service.name} - ${currency(service.price)}`;
      byId('summary-vehicle').textContent = vehicle;
      byId('summary-plate').textContent = plate;
      byId('summary-date').textContent = formatDate(date);
      byId('summary-payment').textContent = payment;
      byId('summary-status').textContent = status;
      byId('summary-discount').textContent = currency(discount);
      byId('summary-notes').textContent = notes || 'Nenhuma';
      byId('sale-summary').style.display = 'block';
      
      // Limpar campos automaticamente para nova venda
      clearSaleForm();
      
      updateDashboard();
      showAlert('Venda registrada com sucesso! Status: ' + status);
    }

    // ========== CONTAS A RECEBER ==========
    function loadBills(){
      const tbody = byId('bills-table-body');
      tbody.innerHTML = '';
      
      sales.forEach(sale => {
        const client = clients.find(c => c.id === sale.clientId);
        const service = services.find(s => s.id === sale.serviceId);
        
        if(!client || !service) return;
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" class="bill-checkbox" value="${sale.id}"></td>
          <td>#${sale.id}</td>
          <td>${client.name}</td>
          <td>${sale.vehicle || 'Não informado'}</td>
          <td>${sale.plate || 'Não informada'}</td>
          <td>${service.name}</td>
          <td>${formatDate(sale.date)}</td>
          <td>${currency(sale.total)}</td>
          <td><span class="status-badge ${sale.status === 'Pago' ? 'status-pago' : 'status-pendente'}">${sale.status}</span></td>
          <td>
            <button class="btn btn-success" onclick="receiveBill(${sale.id})" ${sale.status === 'Pago' ? 'disabled' : ''}>Receber</button>
            <button class="btn btn-muted" onclick="editBill(${sale.id})">Editar</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function searchBills(){
      const clientQuery = byId('search-bills-client').value.toLowerCase().trim();
      const vehicleQuery = byId('search-bills-vehicle').value.toLowerCase().trim();
      const plateQuery = byId('search-bills-plate').value.toLowerCase().trim();
      const dateStart = byId('search-bills-date-start').value;
      const dateEnd = byId('search-bills-date-end').value;
      const statusQuery = byId('search-bills-status').value;
      
      const filtered = sales.filter(sale => {
        const client = clients.find(c => c.id === sale.clientId);
        const matchesClient = !clientQuery || (client && client.name.toLowerCase().includes(clientQuery));
        const matchesVehicle = !vehicleQuery || sale.vehicle.toLowerCase().includes(vehicleQuery);
        const matchesPlate = !plateQuery || sale.plate.toLowerCase().includes(plateQuery);
        const matchesDateStart = !dateStart || sale.date >= dateStart;
        const matchesDateEnd = !dateEnd || sale.date <= dateEnd;
        const matchesStatus = !statusQuery || sale.status === statusQuery;
        
        return matchesClient && matchesVehicle && matchesPlate && matchesDateStart && matchesDateEnd && matchesStatus;
      });
      
      // Recarregar tabela com resultados filtrados
      const tbody = byId('bills-table-body');
      tbody.innerHTML = '';
      
      filtered.forEach(sale => {
        const client = clients.find(c => c.id === sale.clientId);
        const service = services.find(s => s.id === sale.serviceId);
        
        if(!client || !service) return;
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" class="bill-checkbox" value="${sale.id}"></td>
          <td>#${sale.id}</td>
          <td>${client.name}</td>
          <td>${sale.vehicle || 'Não informado'}</td>
          <td>${sale.plate || 'Não informada'}</td>
          <td>${service.name}</td>
          <td>${formatDate(sale.date)}</td>
          <td>${currency(sale.total)}</td>
          <td><span class="status-badge ${sale.status === 'Pago' ? 'status-pago' : 'status-pendente'}">${sale.status}</span></td>
          <td>
            <button class="btn btn-success" onclick="receiveBill(${sale.id})" ${sale.status === 'Pago' ? 'disabled' : ''}>Receber</button>
            <button class="btn btn-muted" onclick="editBill(${sale.id})">Editar</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function clearBillSearch(){
      byId('search-bills-client').value = '';
      byId('search-bills-vehicle').value = '';
      byId('search-bills-plate').value = '';
      byId('search-bills-date-start').value = '';
      byId('search-bills-date-end').value = '';
      byId('search-bills-status').selectedIndex = 0;
      loadBills();
    }

    function toggleSelectAllBills(checkbox){
      const checkboxes = document.querySelectorAll('.bill-checkbox');
      checkboxes.forEach(cb => {
        cb.checked = checkbox.checked;
      });
    }

    function selectAllBills(){
      const checkboxes = document.querySelectorAll('.bill-checkbox');
      checkboxes.forEach(cb => {
        cb.checked = true;
      });
      byId('select-all-bills').checked = true;
    }

    function deselectAllBills(){
      const checkboxes = document.querySelectorAll('.bill-checkbox');
      checkboxes.forEach(cb => {
        cb.checked = false;
      });
      byId('select-all-bills').checked = false;
    }

    function receiveSelectedBills(){
      const checkboxes = document.querySelectorAll('.bill-checkbox:checked');
      if(checkboxes.length === 0) {
        return alert('Selecione pelo menos uma conta para receber');
      }
      
      if(!confirm(`Deseja marcar ${checkboxes.length} conta(s) como recebida(s)?`)) return;
      
      checkboxes.forEach(checkbox => {
        const saleId = parseInt(checkbox.value);
        const sale = sales.find(s => s.id === saleId);
        if(sale) {
          sale.status = 'Pago';
        }
      });
      
      loadBills();
      updateDashboard();
      showAlert(`${checkboxes.length} conta(s) marcada(s) como recebida(s)!`);
    }

    function receiveBill(id){
      const sale = sales.find(s => s.id === id);
      if(!sale) return;
      
      sale.status = 'Pago';
      loadBills();
      updateDashboard();
      showAlert('Conta marcada como recebida!');
    }

    function editBill(id){
      const sale = sales.find(s => s.id === id);
      if(!sale) return;
      
      const newStatus = prompt('Novo status (Pago/Pendente):', sale.status);
      if(newStatus === null) return;
      
      if(newStatus !== 'Pago' && newStatus !== 'Pendente') {
        return alert('Status deve ser "Pago" ou "Pendente"');
      }
      
      sale.status = newStatus;
      loadBills();
      updateDashboard();
      showAlert('Status da conta atualizado!');
    }

    // ========== CONTAS A PAGAR ==========
    function showPayableForm() {
      byId('payable-form-container').style.display = 'block';
      byId('payable-form').reset();
      
      // Definir data padrão (amanhã)
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      byId('payable-due-date').valueAsDate = tomorrow;
    }

    function hidePayableForm() {
      byId('payable-form-container').style.display = 'none';
    }

    function savePayable(event) {
      event.preventDefault();
      
      const payableData = {
        description: byId('payable-description').value,
        supplier: byId('payable-supplier').value,
        value: parseFloat(byId('payable-value').value),
        dueDate: byId('payable-due-date').value,
        notes: byId('payable-notes').value,
        status: 'pending',
        createdAt: new Date().toISOString()
      };
      
      payableData.id = generateId();
      payables.push(payableData);
      
      hidePayableForm();
      loadPayablesTable();
      showAlert('Despesa cadastrada com sucesso!');
    }

    function loadPayablesTable() {
      const tbody = byId('payables-table-body');
      tbody.innerHTML = '';
      
      payables.forEach(payable => {
        const dueDate = new Date(payable.dueDate);
        const isOverdue = payable.status === 'pending' && dueDate < new Date();
        
        const statusClass = payable.status === 'paid' ? 'status-pago' : 
                          isOverdue ? 'status-atrasado' : 'status-pendente';
        const statusText = payable.status === 'paid' ? 'Pago' : 
                         isOverdue ? 'Atrasado' : 'Pendente';
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${payable.description}</td>
          <td>${payable.supplier || '-'}</td>
          <td>${currency(payable.value)}</td>
          <td>${formatDate(payable.dueDate)}</td>
          <td><span class="status-badge ${statusClass}">${statusText}</span></td>
          <td>
            ${payable.status === 'pending' ? `
              <button class="btn btn-success" onclick="markPayableAsPaid(${payable.id})"><i class="fa-solid fa-check"></i> Pagar</button>
            ` : ''}
            <button class="btn btn-muted" onclick="editPayable(${payable.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deletePayable(${payable.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function markPayableAsPaid(payableId) {
      const payableIndex = payables.findIndex(p => p.id === payableId);
      if (payableIndex !== -1) {
        payables[payableIndex].status = 'paid';
        payables[payableIndex].paidDate = new Date().toISOString();
        loadPayablesTable();
        showAlert('Despesa marcada como paga!');
      }
    }

    function editPayable(payableId) {
      const payable = payables.find(p => p.id === payableId);
      if (payable) {
        byId('payable-description').value = payable.description;
        byId('payable-supplier').value = payable.supplier || '';
        byId('payable-value').value = payable.value;
        byId('payable-due-date').value = payable.dueDate;
        byId('payable-notes').value = payable.notes || '';
        
        // Remover a despesa da lista para depois adicionar atualizada
        payables = payables.filter(p => p.id !== payableId);
        showPayableForm();
        showAlert('Preencha os dados e clique em Salvar para atualizar a despesa');
      }
    }

    function deletePayable(payableId) {
      if (confirm('Tem certeza que deseja excluir esta despesa?')) {
        payables = payables.filter(p => p.id !== payableId);
        loadPayablesTable();
        showAlert('Despesa excluída com sucesso!');
      }
    }

    // ========== AGENDAMENTOS ==========
    function loadSchedulingFormOptions(){
      const clientSelect = byId('scheduling-client');
      clientSelect.innerHTML = '<option value="">Selecione um cliente</option>';
      
      clients.forEach(client => {
        const option = document.createElement('option');
        option.value = client.id;
        option.textContent = client.name;
        clientSelect.appendChild(option);
      });
      
      const serviceSelect = byId('scheduling-service');
      serviceSelect.innerHTML = '<option value="">Selecione um serviço</option>';
      
      services.forEach(service => {
        const option = document.createElement('option');
        option.value = service.id;
        option.textContent = service.name;
        serviceSelect.appendChild(option);
      });
    }

    function addScheduling(){
      const clientId = parseInt(byId('scheduling-client').value);
      const serviceId = parseInt(byId('scheduling-service').value);
      const date = byId('scheduling-date').value;
      const time = byId('scheduling-time').value;
      const notes = byId('scheduling-notes').value.trim();
      
      if(!clientId || !serviceId || !date || !time) {
        return alert('Preencha todos os campos obrigatórios');
      }
      
      const newScheduling = {
        id: generateId(),
        clientId,
        serviceId,
        date,
        time,
        notes,
        createdAt: new Date().toISOString()
      };
      
      schedulings.push(newScheduling);
      
      // Limpar campos
      byId('scheduling-client').selectedIndex = 0;
      byId('scheduling-service').selectedIndex = 0;
      byId('scheduling-date').value = '';
      byId('scheduling-time').value = '';
      byId('scheduling-notes').value = '';
      
      loadSchedulingTable();
      loadSchedulingCalendar();
      updateDashboard();
      showAlert('Agendamento realizado com sucesso!');
    }

    function loadSchedulingTable() {
      const tbody = byId('scheduling-table-body');
      tbody.innerHTML = '';
      
      schedulings.forEach(scheduling => {
        const client = clients.find(c => c.id === scheduling.clientId);
        const service = services.find(s => s.id === scheduling.serviceId);
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${client ? client.name : 'Cliente não encontrado'}</td>
          <td>${service ? service.name : 'Serviço não encontrado'}</td>
          <td>${formatDate(scheduling.date)} ${scheduling.time}</td>
          <td>${scheduling.notes || '-'}</td>
          <td>
            <button class="btn btn-muted" onclick="editScheduling(${scheduling.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteScheduling(${scheduling.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function searchScheduling(){
      const query = byId('search-scheduling').value.toLowerCase().trim();
      
      if(!query){
        loadSchedulingTable();
        return;
      }
      
      const filtered = schedulings.filter(scheduling => {
        const client = clients.find(c => c.id === scheduling.clientId);
        const service = services.find(s => s.id === scheduling.serviceId);
        
        return (client && client.name.toLowerCase().includes(query)) ||
               (service && service.name.toLowerCase().includes(query)) ||
               (scheduling.notes && scheduling.notes.toLowerCase().includes(query));
      });
      
      const tbody = byId('scheduling-table-body');
      tbody.innerHTML = '';
      
      filtered.forEach(scheduling => {
        const client = clients.find(c => c.id === scheduling.clientId);
        const service = services.find(s => s.id === scheduling.serviceId);
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${client ? client.name : 'Cliente não encontrado'}</td>
          <td>${service ? service.name : 'Serviço não encontrado'}</td>
          <td>${formatDate(scheduling.date)} ${scheduling.time}</td>
          <td>${scheduling.notes || '-'}</td>
          <td>
            <button class="btn btn-muted" onclick="editScheduling(${scheduling.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteScheduling(${scheduling.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function editScheduling(schedulingId) {
      const scheduling = schedulings.find(s => s.id === schedulingId);
      if (scheduling) {
        byId('scheduling-client').value = scheduling.clientId;
        byId('scheduling-service').value = scheduling.serviceId;
        byId('scheduling-date').value = scheduling.date;
        byId('scheduling-time').value = scheduling.time;
        byId('scheduling-notes').value = scheduling.notes || '';
        
        // Remover o agendamento da lista para depois adicionar atualizado
        schedulings = schedulings.filter(s => s.id !== schedulingId);
        showAlert('Preencha os dados e clique em Agendar para atualizar o agendamento');
      }
    }

    function deleteScheduling(schedulingId) {
      if (confirm('Tem certeza que deseja excluir este agendamento?')) {
        schedulings = schedulings.filter(s => s.id !== schedulingId);
        loadSchedulingTable();
        loadSchedulingCalendar();
        showAlert('Agendamento excluído com sucesso!');
        updateDashboard();
      }
    }

    // ========== CALENDÁRIO ==========
    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();

    function loadSchedulingCalendar() {
      const monthNames = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
                         "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
      
      byId('current-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;
      
      const firstDay = new Date(currentYear, currentMonth, 1);
      const lastDay = new Date(currentYear, currentMonth + 1, 0);
      const daysInMonth = lastDay.getDate();
      const startingDay = firstDay.getDay();
      
      const calendarDays = byId('calendar-days');
      calendarDays.innerHTML = '';
      
      // Dias do mês anterior
      for (let i = 0; i < startingDay; i++) {
        const day = document.createElement('div');
        day.className = 'day other';
        day.textContent = '';
        calendarDays.appendChild(day);
      }
      
      // Dias do mês atual
      for (let i = 1; i <= daysInMonth; i++) {
        const day = document.createElement('div');
        day.className = 'day';
        day.textContent = i;
        
        // Verificar se há agendamentos neste dia
        const dayDate = new Date(currentYear, currentMonth, i);
        const dayISO = dayDate.toISOString().split('T')[0];
        const hasEvent = schedulings.some(s => s.date === dayISO);
        
        if (hasEvent) {
          day.classList.add('has-event');
        }
        
        // Destacar dia atual
        const today = new Date();
        if (dayDate.toDateString() === today.toDateString()) {
          day.classList.add('today');
        }
        
        calendarDays.appendChild(day);
      }
    }

    function prevMonth() {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      loadSchedulingCalendar();
    }

    function nextMonth() {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      loadSchedulingCalendar();
    }

    // ========== CATEGORIAS ==========
    function addCategory(){
      const name = byId('category-name').value.trim();
      const description = byId('category-description').value.trim();
      
      if(!name) return alert('Informe o nome da categoria');
      
      const newCategory = {
        id: generateId(),
        name,
        description,
        createdAt: new Date().toISOString()
      };
      
      categories.push(newCategory);
      
      // Limpar campos
      byId('category-name').value = '';
      byId('category-description').value = '';
      
      loadCategoriesTable();
      showAlert('Categoria adicionada com sucesso!');
    }

    function loadCategoriesTable() {
      const tbody = byId('categories-table-body');
      tbody.innerHTML = '';
      
      categories.forEach(category => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${category.name}</td>
          <td>${category.description || '-'}</td>
          <td>
            <button class="btn btn-muted" onclick="editCategory(${category.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteCategory(${category.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function editCategory(categoryId) {
      const category = categories.find(c => c.id === categoryId);
      if (category) {
        byId('category-name').value = category.name;
        byId('category-description').value = category.description || '';
        
        // Remover a categoria da lista para depois adicionar atualizada
        categories = categories.filter(c => c.id !== categoryId);
        showAlert('Preencha os dados e clique em Adicionar para atualizar a categoria');
      }
    }

    function deleteCategory(categoryId) {
      if (confirm('Tem certeza que deseja excluir esta categoria?')) {
        categories = categories.filter(c => c.id !== categoryId);
        loadCategoriesTable();
        showAlert('Categoria excluída com sucesso!');
      }
    }

    // ========== USUÁRIOS ==========
    function addUser(){
      const name = byId('user-name-input').value.trim();
      const email = byId('user-email').value.trim();
      const password = byId('user-password').value;
      const role = byId('user-role').value;
      
      if(!name || !email || !password) {
        return alert('Preencha nome, email e senha');
      }
      
      const newUser = {
        id: generateId(),
        name,
        email,
        password,
        role,
        createdAt: new Date().toISOString()
      };
      
      users.push(newUser);
      
      // Limpar campos
      byId('user-name-input').value = '';
      byId('user-email').value = '';
      byId('user-password').value = '';
      byId('user-role').selectedIndex = 0;
      
      loadUsersTable();
      showAlert('Usuário adicionado com sucesso!');
    }

    function loadUsersTable() {
      const tbody = byId('users-table-body');
      tbody.innerHTML = '';
      
      users.forEach(user => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${user.name}</td>
          <td>${user.email}</td>
          <td>${user.role}</td>
          <td>
            <button class="btn btn-muted" onclick="editUser(${user.id})"><i class="fa-solid fa-edit"></i></button>
            <button class="btn btn-danger" onclick="deleteUser(${user.id})"><i class="fa-solid fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function editUser(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        byId('user-name-input').value = user.name;
        byId('user-email').value = user.email;
        byId('user-password').value = user.password;
        byId('user-role').value = user.role;
        
        // Remover o usuário da lista para depois adicionar atualizado
        users = users.filter(u => u.id !== userId);
        showAlert('Preencha os dados e clique em Adicionar para atualizar o usuário');
      }
    }

    function deleteUser(userId) {
      if (confirm('Tem certeza que deseja excluir este usuário?')) {
        users = users.filter(u => u.id !== userId);
        loadUsersTable();
        showAlert('Usuário excluído com sucesso!');
      }
    }

    // ========== RECURSOS HUMANOS ==========
    function showEmployeeForm() {
      byId('employee-form-container').style.display = 'block';
      byId('employee-form').reset();
      byId('employee-form-title').textContent = 'Novo Funcionário';
      
      // Definir data padrão (hoje)
      byId('employee-hire-date').valueAsDate = new Date();
      
      // Resetar tabs
      showEmployeeTab('dados-pessoais', document.querySelector('.tab.active'));
    }

    function hideEmployeeForm() {
      byId('employee-form-container').style.display = 'none';
      currentEmployeeId = null;
    }

    function showEmployeeTab(tabId, element) {
      // Esconder todas as tabs
      document.querySelectorAll('.config-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Mostrar a tab selecionada
      byId(tabId).classList.add('active');
      
      // Atualizar tabs ativas
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      element.classList.add('active');
    }

    function saveEmployee(event) {
      event.preventDefault();
      
      // Dados Pessoais
      const personalData = {
        name: byId('employee-name').value,
        cpf: byId('employee-cpf').value,
        rg: byId('employee-rg').value,
        birthdate: byId('employee-birthdate').value,
        gender: byId('employee-gender').value,
        maritalStatus: byId('employee-marital-status').value,
        phone: byId('employee-phone').value,
        email: byId('employee-email').value,
        address: byId('employee-address').value
      };
      
      // Dados Profissionais
      const professionalData = {
        position: byId('employee-position').value,
        department: byId('employee-department').value,
        hireDate: byId('employee-hire-date').value,
        baseSalary: parseFloat(byId('employee-base-salary').value),
        contractType: byId('employee-contract-type').value,
        workHours: parseInt(byId('employee-work-hours').value) || 44,
        status: byId('employee-status').value
      };
      
      // Benefícios
      const benefits = {
        transportAllowance: parseFloat(byId('employee-transport-allowance').value) || 0,
        mealAllowance: parseFloat(byId('employee-meal-allowance').value) || 0,
        foodAllowance: parseFloat(byId('employee-food-allowance').value) || 0,
        healthInsurance: parseFloat(byId('employee-health-insurance').value) || 0,
        otherBenefits: parseFloat(byId('employee-other-benefits').value) || 0,
        notes: byId('employee-notes').value
      };
      
      // Calcular salário total
      const totalSalary = professionalData.baseSalary + 
                         benefits.transportAllowance + 
                         benefits.mealAllowance + 
                         benefits.foodAllowance + 
                         benefits.healthInsurance + 
                         benefits.otherBenefits;
      
      const employeeData = {
        ...personalData,
        ...professionalData,
        ...benefits,
        totalSalary,
        advances: [],
        vacations: [],
        createdAt: new Date().toISOString()
      };
      
      if (currentEmployeeId) {
        // Atualizar funcionário existente
        const index = employees.findIndex(e => e.id === currentEmployeeId);
        if (index !== -1) {
          employeeData.id = currentEmployeeId;
          employeeData.advances = employees[index].advances || [];
          employeeData.vacations = employees[index].vacations || [];
          employees[index] = employeeData;
        }
      } else {
        // Novo funcionário
        employeeData.id = generateId();
        employees.push(employeeData);
      }
      
      hideEmployeeForm();
      loadEmployees();
      showAlert('Funcionário salvo com sucesso!');
    }

    function loadEmployees() {
      const container = byId('employees-container');
      container.innerHTML = '';
      
      employees.forEach(employee => {
        // Calcular dias de férias disponíveis
        const hireDate = new Date(employee.hireDate);
        const today = new Date();
        const monthsWorked = (today.getFullYear() - hireDate.getFullYear()) * 12 + 
                            (today.getMonth() - hireDate.getMonth());
        const vacationDaysEarned = Math.floor(monthsWorked / 12) * 30;
        
        // Calcular dias de férias já usados
        const vacationDaysUsed = employee.vacations ? 
          employee.vacations.reduce((total, vacation) => total + vacation.days, 0) : 0;
        
        const vacationDaysAvailable = vacationDaysEarned - vacationDaysUsed;
        
        // Calcular total de adiantamentos pendentes
        const pendingAdvances = employee.advances ? 
          employee.advances.filter(a => a.status === 'Pendente')
                         .reduce((total, advance) => total + advance.amount, 0) : 0;
        
        const employeeCard = document.createElement('div');
        employeeCard.className = 'employee-card';
        employeeCard.innerHTML = `
          <div class="employee-header">
            <div class="employee-info">
              <div class="employee-avatar">${employee.name.charAt(0)}</div>
              <div class="employee-details">
                <h4>${employee.name}</h4>
                <p>${employee.position} - ${employee.department}</p>
                <p>Admitido em: ${formatDate(employee.hireDate)}</p>
              </div>
            </div>
            <div>
              <span class="status-badge ${employee.status === 'Ativo' ? 'status-pago' : 
                                         employee.status === 'Férias' ? 'status-agendado' : 
                                         employee.status === 'Afastado' ? 'status-pendente' : 
                                         'status-atrasado'}">${employee.status}</span>
            </div>
          </div>
          
          <div class="employee-stats">
            <div class="stat-item">
              <div class="stat-value">${currency(employee.totalSalary)}</div>
              <div class="stat-label">Salário Total</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">${vacationDaysAvailable}</div>
              <div class="stat-label">Dias de Férias</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">${currency(pendingAdvances)}</div>
              <div class="stat-label">Adiantamentos Pendentes</div>
            </div>
          </div>
          
          <div class="salary-breakdown">
            <div class="breakdown-item">
              <span class="breakdown-label">Salário Base:</span>
              <span class="breakdown-value">${currency(employee.baseSalary)}</span>
            </div>
            <div class="breakdown-item">
              <span class="breakdown-label">Benefícios:</span>
              <span class="breakdown-value">${currency(employee.totalSalary - employee.baseSalary)}</span>
            </div>
          </div>
          
          <div class="quick-actions" style="margin-top:15px;">
            <button class="btn btn-primary" onclick="editEmployee(${employee.id})">
              <i class="fa-solid fa-edit"></i> Editar
            </button>
            <button class="btn btn-warning" onclick="showAdvancePanel(${employee.id})">
              <i class="fa-solid fa-hand-holding-usd"></i> Adiantamentos
            </button>
            <button class="btn btn-info" onclick="showVacationPanel(${employee.id})">
              <i class="fa-solid fa-umbrella-beach"></i> Férias
            </button>
            <button class="btn btn-danger" onclick="deleteEmployee(${employee.id})">
              <i class="fa-solid fa-trash"></i> Excluir
            </button>
          </div>
        `;
        
        container.appendChild(employeeCard);
      });
    }

    function editEmployee(employeeId) {
      const employee = employees.find(e => e.id === employeeId);
      if (employee) {
        currentEmployeeId = employeeId;
        
        // Dados Pessoais
        byId('employee-name').value = employee.name;
        byId('employee-cpf').value = employee.cpf;
        byId('employee-rg').value = employee.rg;
        byId('employee-birthdate').value = employee.birthdate;
        byId('employee-gender').value = employee.gender;
        byId('employee-marital-status').value = employee.maritalStatus;
        byId('employee-phone').value = employee.phone;
        byId('employee-email').value = employee.email;
        byId('employee-address').value = employee.address || '';
        
        // Dados Profissionais
        byId('employee-position').value = employee.position;
        byId('employee-department').value = employee.department;
        byId('employee-hire-date').value = employee.hireDate;
        byId('employee-base-salary').value = employee.baseSalary;
        byId('employee-contract-type').value = employee.contractType;
        byId('employee-work-hours').value = employee.workHours;
        byId('employee-status').value = employee.status;
        
        // Benefícios
        byId('employee-transport-allowance').value = employee.transportAllowance || 0;
        byId('employee-meal-allowance').value = employee.mealAllowance || 0;
        byId('employee-food-allowance').value = employee.foodAllowance || 0;
        byId('employee-health-insurance').value = employee.healthInsurance || 0;
        byId('employee-other-benefits').value = employee.otherBenefits || 0;
        byId('employee-notes').value = employee.notes || '';
        
        byId('employee-form-title').textContent = 'Editar Funcionário';
        byId('employee-form-container').style.display = 'block';
        showEmployeeTab('dados-pessoais', document.querySelector('.tab'));
      }
    }

    function deleteEmployee(employeeId) {
      if (confirm('Tem certeza que deseja excluir este funcionário?')) {
        employees = employees.filter(e => e.id !== employeeId);
        loadEmployees();
        showAlert('Funcionário excluído com sucesso!');
      }
    }

    function searchEmployees() {
      const query = byId('search-employee').value.toLowerCase().trim();
      
      if (!query) {
        loadEmployees();
        return;
      }
      
      const filtered = employees.filter(employee => 
        employee.name.toLowerCase().includes(query) ||
        employee.position.toLowerCase().includes(query) ||
        employee.department.toLowerCase().includes(query)
      );
      
      const container = byId('employees-container');
      container.innerHTML = '';
      
      filtered.forEach(employee => {
        // (O mesmo código de loadEmployees para criar os cards)
        // ... (código para criar card do funcionário) ...
      });
    }

    function filterEmployees() {
      const department = byId('filter-department').value;
      const status = byId('filter-status').value;
      
      let filtered = employees;
      
      if (department) {
        filtered = filtered.filter(e => e.department === department);
      }
      
      if (status) {
        filtered = filtered.filter(e => e.status === status);
      }
      
      const container = byId('employees-container');
      container.innerHTML = '';
      
      filtered.forEach(employee => {
        // (O mesmo código de loadEmployees para criar os cards)
        // ... (código para criar card do funcionário) ...
      });
    }

    // ========== RELATÓRIOS ==========
    function loadReportFilters(){
      // Carregar clientes
      const clientSelect = byId('report-sales-client');
      clientSelect.innerHTML = '<option value="">Todos os clientes</option>';
      clients.forEach(client => {
        const option = document.createElement('option');
        option.value = client.id;
        option.textContent = client.name;
        clientSelect.appendChild(option);
      });
      
      // Carregar serviços
      const serviceSelect = byId('report-sales-service');
      serviceSelect.innerHTML = '<option value="">Todos os serviços</option>';
      services.forEach(service => {
        const option = document.createElement('option');
        option.value = service.id;
        option.textContent = service.name;
        serviceSelect.appendChild(option);
      });
    }

    function generateSalesReport(){
      const startDate = byId('report-sales-date-start').value;
      const endDate = byId('report-sales-date-end').value;
      const clientId = byId('report-sales-client').value;
      const serviceId = byId('report-sales-service').value;
      const status = byId('report-sales-status').value;
      
      let filteredSales = sales;
      
      // Aplicar filtros
      if(startDate) filteredSales = filteredSales.filter(s => s.date >= startDate);
      if(endDate) filteredSales = filteredSales.filter(s => s.date <= endDate);
      if(clientId) filteredSales = filteredSales.filter(s => s.clientId === parseInt(clientId));
      if(serviceId) filteredSales = filteredSales.filter(s => s.serviceId === parseInt(serviceId));
      if(status) filteredSales = filteredSales.filter(s => s.status === status);
      
      // Atualizar tabela
      const tbody = byId('sales-report-body');
      tbody.innerHTML = '';
      
      filteredSales.forEach(sale => {
        const client = clients.find(c => c.id === sale.clientId);
        const service = services.find(s => s.id === sale.serviceId);
        
        if(!client || !service) return;
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${formatDate(sale.date)}</td>
          <td>${client.name}</td>
          <td>${sale.vehicle || 'Não informado'}</td>
          <td>${sale.plate || 'Não informada'}</td>
          <td>${service.name}</td>
          <td>${currency(sale.total)}</td>
          <td><span class="status-badge ${sale.status === 'Pago' ? 'status-pago' : 'status-pendente'}">${sale.status}</span></td>
          <td>${sale.payment}</td>
        `;
        tbody.appendChild(tr);
      });
      
      // Atualizar resumo
      updateReportSummary(filteredSales);
      
      // Atualizar gráfico
      updateSalesReportChart(filteredSales);
    }

    function updateReportSummary(salesData){
      const totalSales = salesData.length;
      const totalValue = salesData.reduce((sum, sale) => sum + sale.total, 0);
      const pendingValue = salesData.filter(s => s.status === 'Pendente').reduce((sum, sale) => sum + sale.total, 0);
      const receivedValue = salesData.filter(s => s.status === 'Pago').reduce((sum, sale) => sum + sale.total, 0);
      const averageTicket = totalSales > 0 ? totalValue / totalSales : 0;
      
      byId('report-total-sales').textContent = totalSales;
      byId('report-total-value').textContent = currency(totalValue);
      byId('report-pending-value').textContent = currency(pendingValue);
      byId('report-received-value').textContent = currency(receivedValue);
      byId('report-average-ticket').textContent = currency(averageTicket);
    }

    function updateSalesReportChart(salesData){
      const ctx = byId('salesReportChart').getContext('2d');
      
      // Agrupar por mês
      const monthlyData = {};
      
      salesData.forEach(sale => {
        const date = new Date(sale.date);
        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
        
        if(!monthlyData[monthKey]){
          monthlyData[monthKey] = 0;
        }
        
        monthlyData[monthKey] += sale.total;
      });
      
      const labels = Object.keys(monthlyData).sort();
      const data = labels.map(label => monthlyData[label]);
      
      if(window.salesReportChart){
        window.salesReportChart.destroy();
      }
      
      window.salesReportChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Vendas por Mês',
            data: data,
            backgroundColor: 'rgba(255, 107, 53, 0.6)',
            borderColor: 'rgba(255, 107, 53, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    function exportToExcel(){
      // Simulação de exportação para Excel
      alert('Funcionalidade de exportação para Excel será implementada em breve!');
    }

    // ========== PERFIL ==========
    function fillProfile(){
      byId('profile-name').value = currentUser.name;
      byId('profile-email').value = currentUser.email;
      byId('profile-phone').value = currentUser.phone || '';
    }

    function updateProfile(){
      const name = byId('profile-name').value.trim();
      const email = byId('profile-email').value.trim();
      const phone = byId('profile-phone').value.trim();
      const password = byId('profile-password').value;
      const passwordConfirm = byId('profile-password-confirm').value;
      
      if(!name || !email) {
        return alert('Preencha nome e email');
      }
      
      if(password && password !== passwordConfirm) {
        return alert('As senhas não coincidem');
      }
      
      currentUser.name = name;
      currentUser.email = email;
      currentUser.phone = phone;
      
      if(password) {
        currentUser.password = password;
      }
      
      // Atualizar na lista de usuários
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      if(userIndex !== -1) {
        users[userIndex] = currentUser;
      }
      
      // Atualizar na interface
      byId('user-name').textContent = currentUser.name;
      byId('user-avatar').textContent = currentUser.name.charAt(0);
      
      // Limpar campos de senha
      byId('profile-password').value = '';
      byId('profile-password-confirm').value = '';
      
      showAlert('Perfil atualizado com sucesso!');
    }

    // ========== INICIALIZAÇÃO ==========
    function init(){
      // Configurar datas padrão
      byId('sale-date').value = todayISO();
      byId('scheduling-date').value = todayISO();
      byId('scheduling-time').value = '09:00';
      
      const today = new Date();
      const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
      byId('report-sales-date-start').value = firstDay.toISOString().split('T')[0];
      byId('report-sales-date-end').value = todayISO();
      
      // Carregar dados iniciais
      updateDashboard();
      loadClientsTable();
      loadServicesTable();
      loadCategoriesTable();
      loadUsersTable();
      loadBills();
      loadReportFilters();
      loadSchedulingFormOptions();
      loadSchedulingCalendar();
      loadSchedulingTable();
      loadPayablesTable();
      loadEmployees();
      
      // Configurar usuário atual
      byId('user-name').textContent = currentUser.name;
      byId('user-avatar').textContent = currentUser.name.charAt(0);
      fillProfile();
    }

    // Inicializar quando a página carregar
    window.onload = init;
  </script>
</body>
</html>
